(function(t){function e(e){for(var n,r,o=e[0],i=e[1],u=e[2],l=0,p=[];l<o.length;l++)r=o[l],Object.prototype.hasOwnProperty.call(c,r)&&c[r]&&p.push(c[r][0]),c[r]=0;for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n]);d&&d(e);while(p.length)p.shift()();return s.push.apply(s,u||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],n=!0,r=1;r<a.length;r++){var i=a[r];0!==c[i]&&(n=!1)}n&&(s.splice(e--,1),t=o(o.s=a[0]))}return t}var n={},c={app:0},s=[];function r(t){return o.p+"js/"+({}[t]||t)+"."+{"chunk-16a56688":"b84729a7","chunk-2d0afdf8":"f4f28068","chunk-2d0b2197":"984fc161","chunk-2d0b382f":"9eb8eb4e","chunk-2d0cbe1b":"a596ac3d","chunk-2d221b88":"4945b7c5","chunk-2d225006":"76983516","chunk-41d665cf":"4f27f7c6","chunk-574c34ab":"2c7a65ce","chunk-7e6d774d":"e0969f5d","chunk-db6f551e":"03628edd"}[t]+".js"}function o(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.e=function(t){var e=[],a=c[t];if(0!==a)if(a)e.push(a[2]);else{var n=new Promise((function(e,n){a=c[t]=[e,n]}));e.push(a[2]=n);var s,i=document.createElement("script");i.charset="utf-8",i.timeout=120,o.nc&&i.setAttribute("nonce",o.nc),i.src=r(t);var u=new Error;s=function(e){i.onerror=i.onload=null,clearTimeout(l);var a=c[t];if(0!==a){if(a){var n=e&&("load"===e.type?"missing":e.type),s=e&&e.target&&e.target.src;u.message="Loading chunk "+t+" failed.\n("+n+": "+s+")",u.name="ChunkLoadError",u.type=n,u.request=s,a[1](u)}c[t]=void 0}};var l=setTimeout((function(){s({type:"timeout",target:i})}),12e4);i.onerror=i.onload=s,document.head.appendChild(i)}return Promise.all(e)},o.m=t,o.c=n,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(a,n,function(e){return t[e]}.bind(null,n));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o.oe=function(t){throw console.error(t),t};var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var d=u;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d"),a("159b"),a("b64b");var n=a("2b0e"),c=a("2f62"),s=a("bc3a"),r=a.n(s),o=a("2106"),i=a.n(o),u=a("9062"),l=a.n(u),d=(a("e40d"),a("7bb1")),p=a("60d4"),f=a("4c93"),m=(a("7b17"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view")],1)}),h=[],b={name:"App"},g=b,v=(a("5c0b"),a("2877")),C=Object(v["a"])(g,m,h,!1,null,null,null),y=C.exports,_=(a("d3b7"),a("3ca3"),a("ddb0"),a("8c4f")),k=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),a("Navbar"),a("Alert"),a("router-view"),a("Footer")],1)},O=[],E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",{staticClass:"header bg-light py-4"},[n("nav",{staticClass:"navbar navbar-expand-md"},[n("div",{staticClass:"container"},[t._m(0),n("router-link",{staticClass:"navbar-brand",attrs:{to:"/"}},[n("img",{attrs:{src:a("a1d8"),width:"65",height:"75",alt:"logo"}})]),n("ShoppingCart",{staticClass:"d-md-none nav-cart text-primary"}),n("div",{staticClass:"collapse navbar-collapse",attrs:{id:"navbarNav"}},[n("ul",{staticClass:"navbar-nav fz-4 ms-md-auto letter-spacing-2"},[n("li",{staticClass:"nav-item me-2"},[n("router-link",{staticClass:"nav-link px-2",attrs:{to:"/"}},[t._v(" 首頁 ")])],1),n("li",{staticClass:"nav-item me-2"},[n("router-link",{staticClass:"nav-link px-2",attrs:{to:"/products"}},[t._v(" 產品介紹 ")])],1),n("li",{staticClass:"nav-item "},[n("router-link",{staticClass:"nav-link px-2",attrs:{to:"/login"}},[t._v(" 管理員登入 ")])],1)])]),n("ShoppingCart",{staticClass:"d-none d-md-block nav-cart text-primary ms-4"})],1)])])},x=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{staticClass:"navbar-toggler collapsed",attrs:{type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"}},[a("span",{staticClass:"icon-bar"}),a("span",{staticClass:"icon-bar"}),a("span",{staticClass:"icon-bar"})])}],A=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"d-flex align-items-center"},[a("a",{staticClass:"cart nav-link",on:{click:function(e){e.preventDefault(),t.cartVisible=!t.cartVisible}}},[a("i",{staticClass:"fas fa-shopping-cart"}),t.cart.carts.length?a("span",{staticClass:"cart_num badge rounded-circle bg-danger text-white"},[a("small",[t._v(t._s(t.cart.carts.length))])]):t._e()]),a("transition",{attrs:{name:"slide"}},[t.cartVisible?a("div",{staticClass:"cart_content bg-light rounded p-4"},[t.cart.carts.length&&t.checkoutCart?a("form",{staticClass:"fz-2"},[a("div",{staticClass:"table_scroll"},[a("table",{staticClass:"table"},[a("thead",[a("tr",[a("th",{attrs:{width:"10"}}),a("th",{attrs:{width:"110"}},[t._v("品名")]),a("th",{staticClass:"text-end",attrs:{width:"40"}},[t._v("數量")]),a("th",{staticClass:"text-end",attrs:{width:"40"}},[t._v("單價")])])]),a("tbody",t._l(t.cart.carts,(function(e){return a("tr",{key:e.id},[a("td",[a("button",{staticClass:"btn p-0",attrs:{type:"button"},on:{click:function(a){return a.stopPropagation(),t.removeCartItem(e.id)}}},[a("i",{staticClass:"fas fa-trash-alt fa-xs"})])]),a("td",{staticClass:"align-middle fz-1"},[t._v(" "+t._s(e.product.title)+" ")]),a("td",{staticClass:"text-end"},[a("div",{staticClass:"btn-group",attrs:{role:"group"}},[a("button",{staticClass:"btn btn-outline-lightGray btn-sm",attrs:{type:"button"},on:{click:function(a){return t.minusBuyNum(e.id)}}},[t._v("-")]),a("button",{staticClass:"btn btn-outline-lightGray btn-sm",attrs:{disabled:""}},[t._v(t._s(e.qty))]),a("button",{staticClass:"btn btn-outline-lightGray btn-sm",attrs:{type:"button"},on:{click:function(a){return t.addBuyNum(e.id)}}},[t._v("+")])])]),e.product.price?a("td",{staticClass:"align-middle"},[t._v(" "+t._s(t.currencyFilter(e.product.price))+" ")]):a("td",{staticClass:"align-middle"},[t._v(" "+t._s(t.currencyFilter(e.product.origin_price))+" ")])])})),0)])]),a("div",{staticClass:"d-flex justify-content-end align-items-lg-baseline py-4"},[t._v(" 總計金額"),a("span",{staticClass:"fz-4 ms-4 me-1"},[t._v(t._s(t.currencyFilter(t.total)))]),t._v("元 ")]),a("button",{staticClass:"btn btn-primary w-100",attrs:{type:"button"},on:{click:function(e){return t.addManyToCart(t.$router,"/cart")}}},[t._v(" 結帳去"),a("i",{staticClass:"fas fa-shopping-bag ms-2"})])]):t._e(),t.checkoutCart?t._e():a("div",{staticClass:"flex-center flex-column"},[a("i",{staticClass:"fas fa-cart-arrow-down fz-11 mb-4"}),a("p",{staticClass:"fz-4 fw_bold mb-4"},[t._v("訂單處理中")])]),!t.cart.carts.length&&t.checkoutCart?a("div",{staticClass:"flex-center flex-column"},[a("i",{staticClass:"fas fa-cart-arrow-down fz-11 mb-4"}),a("p",{staticClass:"fz-4 fw_bold mb-4"},[t._v("您的購物車是空的")]),a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.goShopping}},[t._v(" 去逛逛"),a("i",{staticClass:"far fa-caret-square-right ms-2"})])]):t._e()]):t._e()])],1)},M=[],N=a("5530"),D=(a("a9e3"),a("ac1f"),a("5319"),a("b680"),{name:"ShoppingCart",data:function(){return{cartVisible:!1}},methods:Object(N["a"])({removeCartItem:function(t){this.$store.dispatch("removeCartItem",t)},minusBuyNum:function(t){this.$store.dispatch("minusBuyNum",t)},addBuyNum:function(t){this.$store.dispatch("addBuyNum",t)},createOrder:function(t){this.$store.dispatch("createOrder",t)},addManyToCart:function(t,e){this.$store.dispatch("addManyToCart",{router:t,path:e}),this.cartVisible=!1},goShopping:function(){this.$router.push("/products"),this.cartVisible=!1},currencyFilter:function(t){var e=Number(t);return"$".concat(e.toFixed(0).replace(/./g,(function(t,e,a){var n=e&&"."!==t&&(a.length-e)%3===0?", ".concat(t).replace(/\s/g,""):t;return n})))}},Object(c["b"])(["getCart"])),computed:Object(N["a"])({total:function(){var t=this,e=0;return t.cart.carts&&t.cart.carts.forEach((function(t){e+=t.qty*t.product.price})),e}},Object(c["c"])(["cart","tempCart","checkoutCart"])),created:function(){this.getCart()}}),w=D,T=Object(v["a"])(w,A,M,!1,null,null,null),I=T.exports,S={name:"Navbar",components:{ShoppingCart:I}},L=S,G=Object(v["a"])(L,E,x,!1,null,null,null),j=G.exports,P=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},R=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("footer",{staticClass:"bg-primary py-6 text-center text-light fz-1"},[a("div",{staticClass:"container"},[a("p",[t._v("© 2021 "),a("span",{staticClass:"text-white fz-4 fw_bold"},[t._v("日作豆腐工房")]),t._v(" All rights reserved. Design by Allanideal.")])])])}],$={},U=Object(v["a"])($,P,R,!1,null,null,null),q=U.exports,B=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"message-alert"},t._l(t.messages,(function(e,n){return a("div",{key:n,staticClass:"alert alert-dismissible",class:"alert-"+e.status},[a("span",{domProps:{innerHTML:t._s(e.message)}}),a("button",{staticClass:"btn ms-2",attrs:{type:"button","aria-label":"Close"},on:{click:function(e){return t.removeMessage(n)}}},[a("i",{staticClass:"fas fa-times text-third"})])])})),0)},z=[],V={name:"AlertMessage",methods:{updateMessage:function(t,e){this.$store.dispatch("updateMessage",{message:t,status:e})},removeMessage:function(t){this.$store.dispatch("removeMessage",t)}},computed:Object(N["a"])({},Object(c["c"])(["messages"])),created:function(){}},F=V,H=Object(v["a"])(F,B,z,!1,null,null,null),Y=H.exports,J={name:"Home",components:{Navbar:j,Footer:q,Alert:Y},computed:{isLoading:function(){return this.$store.state.isLoading}}},K=J,W=Object(v["a"])(K,k,O,!1,null,null,null),Q=W.exports;n["a"].use(_["a"]);var X=[{path:"/",component:Q,children:[{path:"/",name:"Index",component:function(){return a.e("chunk-db6f551e").then(a.bind(null,"8a2e"))},meta:{title:"日作 - 豆腐工房"}},{path:"products",name:"Products",component:function(){return a.e("chunk-41d665cf").then(a.bind(null,"81b1"))}},{path:"product/:productId",name:"Product",component:function(){return a.e("chunk-2d0afdf8").then(a.bind(null,"0fd0"))}},{path:"cart",name:"Cart",component:function(){return a.e("chunk-2d0b2197").then(a.bind(null,"2355"))}},{path:"cart_order",name:"CartOrder",component:function(){return a.e("chunk-2d221b88").then(a.bind(null,"cc0b"))}},{path:"cart_checkout/:orderId",name:"CartCheckout",component:function(){return a.e("chunk-2d0cbe1b").then(a.bind(null,"4c0f"))}}]},{path:"*",redirect:"login"},{path:"/login",name:"Login",component:function(){return a.e("chunk-2d0b382f").then(a.bind(null,"294f"))}},{path:"/admin",name:"Dashboard",component:function(){return a.e("chunk-2d225006").then(a.bind(null,"e313"))},children:[{path:"products_manage",name:"ProductsManage",component:function(){return a.e("chunk-7e6d774d").then(a.bind(null,"557a"))},meta:{requiresAuth:!0}},{path:"coupons",name:"Coupons",component:function(){return a.e("chunk-574c34ab").then(a.bind(null,"8c58"))},meta:{requiresAuth:!0}},{path:"orders",name:"Orders",component:function(){return a.e("chunk-16a56688").then(a.bind(null,"efd9"))},meta:{requiresAuth:!0}}]}],Z=new _["a"]({routes:X}),tt=Z,et=(a("99af"),a("a434"),a("6062"),a("a630"),{state:{products:[],product:{},categories:[]},actions:{getProducts:function(t){var e="".concat("https://vue-course-api.hexschool.io","/api/").concat("bluesky","/products/all");t.commit("LOADING",!0),r.a.get(e).then((function(e){e.data.success?t.commit("PRODUCTS",e.data.products):t.dispatch("updateMessage",{message:e.data.message,status:"danger"}),t.commit("CATEGORIES",e.data.products),t.commit("LOADING",!1)})).catch((function(e){t.dispatch("updateMessage",{message:e,status:"danger"})}))},getProduct:function(t,e){var a="".concat("https://vue-course-api.hexschool.io","/api/").concat("bluesky","/product/").concat(e);t.commit("LOADING",!0),r.a.get(a).then((function(e){t.commit("PRODUCT",e.data.product),t.commit("LOADING",!1)}))}},mutations:{PRODUCTS:function(t,e){t.products=e},PRODUCT:function(t,e){t.product=e},CATEGORIES:function(t,e){var a=new Set;e.forEach((function(t){a.add(t.category)})),t.categories=Array.from(a)}},getters:{products:function(t){return t.products},product:function(t){return t.product},categories:function(t){return t.categories}}}),at={state:{cart:{carts:[{}]},tempCart:{carts:[]}},actions:{getCart:function(t){var e="".concat("https://vue-course-api.hexschool.io","/api/").concat("bluesky","/cart");t.commit("LOADING",!0),r.a.get(e).then((function(e){e.data.success&&t.commit("CART",e.data.data),t.commit("LOADING",!1)}))},removeCartItem:function(t,e){var a="".concat("https://vue-course-api.hexschool.io","/api/").concat("bluesky","/cart/").concat(e);t.commit("LOADING",!0),r.a.delete(a).then((function(e){console.log(e),t.dispatch("getCart"),t.commit("LOADING",!1)}))},addBuyNum:function(t,e){t.commit("ADDBUYNUM",e)},minusBuyNum:function(t,e){t.commit("MINUSBUYNUM",e)},addToCart:function(t,e){var a=e.id,n=e.buyNum,c="".concat("https://vue-course-api.hexschool.io","/api/").concat("bluesky","/cart"),s={product_id:a,qty:n};r.a.post(c,{data:s}).then((function(e){console.log(e),t.dispatch("getCart"),t.dispatch("updateMessage",{message:'<i class="fas fa-info-circle me-2"></i>'.concat(e.data.data.product.title," 已成功加入購物車"),status:"primary"})}))},addManyToCart:function(t,e){var a=e.router,n=e.path;function c(){return new Promise((function(e){t.commit("TEMPCART"),t.state.tempCart.carts.forEach((function(a){var n="".concat("https://vue-course-api.hexschool.io","/api/").concat("bluesky","/cart/").concat(a.id);r.a.delete(n).then();var c="".concat("https://vue-course-api.hexschool.io","/api/").concat("bluesky","/cart"),s={product_id:a.product_id,qty:a.qty};r.a.post(c,{data:s}).then((function(a){a.data.success&&(t.dispatch("getCart"),e())}))}))}))}c().then((function(){a.push(n)}))}},mutations:{CART:function(t,e){t.cart=e},TEMPCART:function(t){t.tempCart=t.cart},ADDBUYNUM:function(t,e){t.cart.carts.forEach((function(t){t.id===e&&(t.qty+=1)}))},MINUSBUYNUM:function(t,e){t.cart.carts.forEach((function(t){t.id===e&&t.qty>1&&(t.qty-=1)}))}},getters:{cart:function(t){return t.cart},tempCart:function(t){return t.tempCart}}};n["a"].use(c["a"]);var nt=new c["a"].Store({strict:!0,state:{isLoading:!1,messages:[],order:{user:{},products:{}},steps:1,checkoutCart:!0},actions:{updateLoading:function(t,e){t.commit("LOADING",e)},updateMessage:function(t,e){var a=e.message,n=e.status,c=Math.floor(new Date/1e3),s={message:a,status:n,timestamp:c};t.commit("UPDATEMESSAGE",s),setTimeout((function(){t.commit("MESSAGETIMEING",c)}),5e3)},removeMessage:function(t,e){t.commit("REMOVEMESSAGE",e)},addCouponCode:function(t,e){var a="".concat("https://vue-course-api.hexschool.io","/api/").concat("bluesky","/coupon"),n={code:e};t.commit("LOADING",!0),r.a.post(a,{data:n}).then((function(e){t.dispatch("getCart"),t.commit("LOADING",!1)}))},getOrder:function(t,e){var a="".concat("https://vue-course-api.hexschool.io","/api/").concat("bluesky","/order/").concat(e);t.commit("LOADING",!0),r.a.get(a).then((function(e){console.log(e),t.commit("ORDER",e.data.order),t.commit("LOADING",!1)}))},payOrder:function(t,e){if(t.commit("ADDORDER"),1===t.state.steps)t.dispatch("getOrder",e),console.log(t.state.steps);else if(2===t.state.steps){var a="".concat("https://vue-course-api.hexschool.io","/api/").concat("bluesky","/pay/").concat(e);t.commit("LOADING",!0),r.a.post(a).then((function(a){a.data.success&&t.dispatch("getOrder",e),t.commit("LOADING",!1)}))}},checkoutCartPage:function(t,e){t.commit("CHECKOUTCART",e)}},mutations:{LOADING:function(t,e){t.isLoading=e},UPDATEMESSAGE:function(t,e){t.messages.push(e)},MESSAGETIMEING:function(t,e){t.messages.forEach((function(a,n){a.timestamp===e&&t.messages.splice(n,1)}))},REMOVEMESSAGE:function(t,e){t.messages.splice(e,1)},ORDER:function(t,e){t.order=e},ADDORDER:function(t){t.steps++},CHECKOUTCART:function(t,e){t.checkoutCart=e}},getters:{isLoading:function(t){return t.isLoading},order:function(t){return t.order},steps:function(t){return t.steps},checkoutCart:function(t){return t.checkoutCart},messages:function(t){return t.messages}},modules:{productModules:et,cartModules:at}});n["a"].config.productionTip=!1,n["a"].use(i.a,r.a),n["a"].use(c["a"]),Object.keys(f).forEach((function(t){Object(d["d"])(t,f[t])})),Object(d["e"])("zh_TW",p),Object(d["c"])({classes:{valid:"is-valid",invalid:"is-invalid"}}),n["a"].component("ValidationObserver",d["a"]),n["a"].component("ValidationProvider",d["b"]),n["a"].component("Loading",l.a),new n["a"]({router:tt,store:nt,render:function(t){return t(y)}}).$mount("#app"),tt.beforeEach((function(t,e,a){if(t.meta.requiresAuth){var n="https://vue-course-api.hexschool.io",c="".concat(n,"/api/user/check");r.a.post(c).then((function(t){t.data.success?a():a({path:"/login"})}))}else a()}))},"5c0b":function(t,e,a){"use strict";a("9c0c")},"9c0c":function(t,e,a){},a1d8:function(t,e,a){t.exports=a.p+"img/logo.f0dc14a7.png"}});
//# sourceMappingURL=app.0adc2edc.js.map